
<body >
  <div style="display: flex;">
    <div>
      <div  style="background-color: #f5f5f5;">
        <div class="ant-card" style="max-width: 1200px; margin: auto; border: 1px solid black; background: white;">
          <!-- Header -->
          <div nz-row [nzGutter]="[16, 16]" class="ant-row ant-row-middle ant-row-space-between" style="border-bottom: 1px solid black;">
            <div nz-col [nzSpan]="4" style="border-right: 1px solid black; padding: 16px;">
              <img src="./assets/pdf/logo1.png" alt="Marcobre Logo" style="object-fit: contain; width: 150px; height: 50px;" />
            </div>
            <div nz-col [nzSpan]="16" style="padding: 16px; text-align: center;">
              <h1 style="font-size: 18px; font-weight: bold;">MANTENIMIENTO PROGRAMADO DE SUB ESTACIONES TIPO ESTACIÓN - PM1</h1>
              <div nz-row [nzGutter]="16" style="margin-top: 16px;">
                <div nz-col [nzSpan]="12" style="text-align: left;">
                  <span style="font-weight: bold;">Área:</span>
                  <span>Electricidad y Potencia</span>
                </div>
                <div nz-col [nzSpan]="12" style="text-align: right;">
                  <span style="font-weight: bold;">Versión:</span>
                  <span>004</span>
                </div>
              </div>
              <div nz-row [nzGutter]="16" style="margin-top: 8px; display: flex; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span style="font-weight: bold;">Fecha:</span>
                  <span>20-09-2023</span>
                </div>
                <div style="display: flex; align-items: center; gap: 16px;">
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-weight: bold;">Documento:</span>
                    <span>MJ-EP-MPSETE-001</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-weight: bold;">Página:</span>
                    <span>1 de 1</span>
                  </div>
                </div>
              </div>
            </div>
            <div nz-col [nzSpan]="4" style="border-left: 1px solid black; padding: 16px;">
              <img src="./assets/pdf/logo2.png" alt="Mina Justa Logo" style="object-fit: contain; width: 150px; height: 50px;" />
            </div>
          </div>

           <!-- Substation -->
           <div style="border: 1px solid black; width: 100%;margin-top: 15px;">
            <div nz-row [nzGutter]="0">
              <!-- Left Section -->
              <div nz-col [nzSpan]="8" style="border-right: 1px solid black;align-items: center;
              display: flex
          ;   ">
                <div style="display: flex; align-items: center;">
                  <label
                    for="tag-sub-estacion"
                    style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding: 4px; margin-right: 8px;">
                    Tag de la sub estación:
                  </label>
                  <input
                    nz-input
                    id="tag-sub-estacion"
                    [(ngModel)]="subestacion"
                    style="flex: 1;height: 50px;"
                  />
                </div>
              </div>

              <!-- Middle Section -->
              <div nz-col [nzSpan]="8" style="border-right: 1px solid black;">
                <div style="display: flex; flex-direction: column;"> <!-- Aumentado height -->
                  <!-- Ubicación -->
                  <div style="display: flex; align-items: center; border-bottom: 1px solid black;">
                    <label
                      for="ubicacion"
                      style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding: 4px; margin-right: 8px;">
                      Ubicación:
                    </label>
                    <input
                      nz-input
                      id="ubicacion"
                      [(ngModel)]="ubicacion"
                      style="flex: 1;"
                    />
                  </div>
                  <!-- Horas -->
                  <div nz-row [nzGutter]="0" style="height: 60%;">
                    <div nz-col [nzSpan]="12" style="border-right: 1px solid black;">
                      <div style="display: flex; align-items: center;">
                        <label
                          for="hora-inicio"
                          style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding: 4px; margin-right: 8px;">
                          Hora Inicio:
                        </label>
                        <input
                          type="time"
                          nz-input
                          id="hora-inicio"
                          [(ngModel)]="horaInicio"
                          style="flex: 1;"
                        />
                      </div>
                    </div>
                    <div nz-col [nzSpan]="12">
                      <div style="display: flex; align-items: center;">
                        <label
                          for="hora-fin"
                          style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding: 4px; margin-right: 8px;">
                          Hora de Fin:
                        </label>
                        <input
                          type="time"
                          nz-input
                          id="hora-fin"
                          [(ngModel)]="horaFin"
                          style="flex: 1;"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Right Section -->
              <div nz-col [nzSpan]="8">
                <div style="display: flex; flex-direction: column;"> <!-- Ajustado height -->
                  <div style="display: flex; align-items: center; border-bottom: 1px solid black;">
                    <label
                      for="orden-trabajo"
                      style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding: 4px; margin-right: 8px;">
                      Orden de Trabajo:
                    </label>
                    <input
                      nz-input
                      id="orden-trabajo"
                      [(ngModel)]="ordenTrabajo"
                      style="flex: 1;"
                    />
                  </div>
                  <div style="display: flex; align-items: center;">
                    <label
                      for="fecha-orden"
                      style="font-weight: bold; white-space: nowrap; background-color: #f5e6d3; padding-left: 8px;
    padding-right: 74px;; margin-right: 8px;">
                      Fecha:
                    </label>
                    <input
                      type="date"
                      nz-input
                      id="fecha-orden"
                      [(ngModel)]="fechaOrden"
                      style="flex: 1;"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Seguridad e Observaciones con tabla -->

        <div style="border-top: 1px solid black;margin-top: 7px;">
          <div style="display: grid; grid-template-columns: 550px 120px 440px; background: #f5e6d3; border-bottom: 1px solid black;">
            <div style="padding: 8px; font-weight: bold;">INSTRUCCIONES DE SEGURIDAD</div>
            <div style="border-left: 1px solid black; border-right: 1px solid black; text-align: center; font-weight: bold; padding: 8px;">✓ N/A</div>
            <div style="text-align: center; font-weight: bold; padding: 8px;">OBSERVACIONES</div>
          </div>

          <div *ngFor="let observacion of seguridadObservaciones; let i = index" style="display: grid; grid-template-columns: 550px 120px 440px; border-bottom: 1px solid black;">
            <div style="padding: 8px;">
              <label style="width: 100%;">{{ observacion.descripcion }}</label>
            </div>
            <div style="border-left: 1px solid black; border-right: 1px solid black; padding: 8px; display: flex; justify-content: center; gap: 16px;">
              <label style="display: flex; align-items: center; gap: 4px;">
                <input type="checkbox" [(ngModel)]="seguridadObservaciones[i].bueno">
              </label>
              <label style="display: flex; align-items: center; gap: 4px;">
                <input type="checkbox" [(ngModel)]="seguridadObservaciones[i].na">
              </label>
            </div>
            <div style="padding: 8px;">
              <input [(ngModel)]="seguridadObservaciones[i].observaciones" style="width: 73%;">
            </div>
          </div>
        </div>

           <!-- Activities Section -->
           <div style="background: #f5e6d3; padding: 8px; border-bottom: 1px solid black; display: grid; grid-template-columns: 1fr 1fr;">
            <div style="font-weight: bold;">ACTIVIDADES A DESARROLLAR</div>
            <div style="font-size: 12px;">
              <span style="color: #ff4d4f; font-weight: bold;">INSTRUCCIONES: </span>
              Seleccionar "BUEN ESTADO" si no tiene observaciones, "OBSERVADO" si tiene observaciones, describir acción y solicitar aviso, llenar los valores de los instrumentos (actual / testigo).
            </div>
          </div>

          <div nz-row [nzGutter]="[16, 16]" style="max-width: 1000px; margin: 16px;padding: 10px;">
            <!-- Left Side -->
            <div nz-col [nzSpan]="12" style="    display: flex
            ;
                justify-content: space-around;">
              <label class="font-bold text-sm" style="font-weight: bold;">TAG DEL TRANSFORMADOR</label>
              <p style="border: 1px solid black; height: 24px; width: 200px; text-align: center;">{{ this.transformador }}</p>
            </div>

            <!-- Right Side -->
            <div nz-col [nzSpan]="12" style="text-align: right;">
              <div style="margin-bottom: 8px;">
                <label class="font-bold text-sm" style="font-weight: bold;">POTENCIA ACTUAL:</label>
                <input type="text" style="border: 1px solid black; height: 24px; width: 100px; margin-right: 4px;" [(ngModel)]="potenciaActual">
                <span style="font-weight: bold;">MW</span>
              </div>

              <div>
                <label class="font-bold text-sm" style="font-weight: bold;">CORRIENTE ACTUAL:</label>
                <input type="text" style="border: 1px solid black; height: 24px; width: 100px; margin-right: 4px;" [(ngModel)]="corrienteActual">
                <span style="font-weight: bold;">A</span>
              </div>
            </div>
          </div>

         <!-- Transformer Section -->
<div nz-row [nzGutter]="[16, 16]" style="padding: 10px;">
  <!-- Formulario 1 -->
  <div nz-col [nzSpan]="6">
    <div *ngFor="let item of transformador1?.form1?.items || []" style="margin-bottom: 16px;">
      <label style="font-weight: bold;">{{ item.label }}</label>

      <!-- Options -->
      <ng-container *ngIf="item.opciones && item.tipo === 'opciones'">
        <nz-select [(ngModel)]="item.valor" style="width: 100%;">
          <nz-option *ngFor="let opcion of item.opciones" [nzValue]="opcion" [nzLabel]="opcion"></nz-option>
        </nz-select>
      </ng-container>

      <!-- Values -->
      <ng-container *ngIf="item.valores && item.tipo === 'valores'">
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <input [(ngModel)]="item.valores[0]" style="width: 80px;" placeholder="v. real">
          <input [(ngModel)]="item.valores[1]" style="width: 80px;" placeholder="v. testigo">

          <span *ngIf="item.label.trim() === 'Manovacuómetro'" style="font-size: 12px;">kgf/cm²</span>
          <span *ngIf="item.label.trim() === 'Termómetro de aceite' || item.label.trim() === 'Termómetro de devanado'" style="font-size: 12px;">°C</span>

        </div>



      </ng-container>
    </div>
  </div>

  <!-- Technical Image -->
  <div nz-col [nzSpan]="12">
    <div style="background: white; border: 1px solid #d9d9d9; border-radius: 4px; text-align: center; height: 400px; display: flex; align-items: center; justify-content: center;">
      <img [src]="transformador1?.imagen || ''" alt="Diagrama técnico del Transformador 1" style="max-height: 100%; max-width: 100%;">
    </div>
  </div>

  <!-- Formulario 2 -->
  <div nz-col [nzSpan]="6">
    <div *ngFor="let item of transformador1?.form2?.items || []" style="margin-bottom: 16px;">
      <label style="font-weight: bold;">{{ item.label }}</label>

      <!-- Options -->
      <ng-container *ngIf="item.opciones && item.tipo === 'opciones'">
        <nz-select [(ngModel)]="item.valor" style="width: 100%;">
          <nz-option *ngFor="let opcion of item.opciones" [nzValue]="opcion" [nzLabel]="opcion"></nz-option>
        </nz-select>
      </ng-container>

      <!-- Values -->
      <ng-container *ngIf="item.valores && item.tipo === 'valores'">
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <input [(ngModel)]="item.valores[0]" style="width: 80px;" placeholder="v. real">
          <input [(ngModel)]="item.valores[1]" style="width: 80px;" placeholder="v. testigo">

          <span *ngIf="item.label.trim() === 'Manovacuómetro'" style="font-size: 12px;">kgf/cm²</span>
          <span *ngIf="item.label.trim() === 'Termómetro de aceite' || item.label.trim() === 'Termómetro de devanado'" style="font-size: 12px;">°C</span>
        </div>


      </ng-container>
    </div>
  </div>
</div>

<div class="ant-divider" style="background-color: black; height: 1px;"></div>

<!-- Transformer 2 Section -->
<div nz-row [nzGutter]="[16, 16]" style="margin: auto; margin-top: 32px; padding: 10px;">
  <!-- Formulario 3 -->
  <div nz-col [nzSpan]="6">
    <div *ngFor="let item of transformador2?.form3?.items || []" style="margin-bottom: 16px;">
      <label style="font-weight: bold;">{{ item.label }}</label>

      <!-- Options -->
      <ng-container *ngIf="item.opciones && item.tipo === 'opciones'">
        <nz-select [(ngModel)]="item.valor" style="width: 100%;">
          <nz-option *ngFor="let opcion of item.opciones" [nzValue]="opcion" [nzLabel]="opcion"></nz-option>
        </nz-select>
      </ng-container>

      <!-- Values -->
      <ng-container *ngIf="item.valores && item.tipo === 'valores'">
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <input [(ngModel)]="item.valores[0]" style="width: 80px;" placeholder="v. real">
          <input [(ngModel)]="item.valores[1]" style="width: 80px;" placeholder="v. testigo">

          <span *ngIf="item.label.trim() === 'Manovacuómetro'" style="font-size: 12px;">kgf/cm²</span>
          <span *ngIf="item.label.trim() === 'Termómetro de aceite' || item.label.trim() === 'Termómetro de devanado'" style="font-size: 12px;">°C</span>
        </div>


      </ng-container>
    </div>
  </div>

  <!-- Technical Image -->
  <div nz-col [nzSpan]="12">
    <div style="background: white; border: 1px solid #d9d9d9; border-radius: 4px; text-align: center; height: 400px; display: flex; align-items: center; justify-content: center;">
      <img [src]="transformador2?.imagen || ''" alt="Diagrama técnico del Transformador 2" style="max-height: 100%; max-width: 100%;">
    </div>
  </div>

  <!-- Formulario 4 -->
  <div nz-col [nzSpan]="6">
    <div *ngFor="let item of transformador2?.form4?.items || []" style="margin-bottom: 16px;">
      <label style="font-weight: bold;">{{ item.label }}</label>

      <!-- Options -->
      <ng-container *ngIf="item.opciones && item.tipo === 'opciones'">
        <nz-select [(ngModel)]="item.valor" style="width: 100%;">
          <nz-option *ngFor="let opcion of item.opciones" [nzValue]="opcion" [nzLabel]="opcion"></nz-option>
        </nz-select>
      </ng-container>

      <!-- Values -->
      <ng-container *ngIf="item.valores && item.tipo === 'valores'">
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <input [(ngModel)]="item.valores[0]" style="width: 80px;" placeholder="v. real">
          <input [(ngModel)]="item.valores[1]" style="width: 80px;" placeholder="v. testigo">

          <span *ngIf="item.label.trim() === 'Manovacuómetro'" style="font-size: 12px;">kgf/cm²</span>
          <span *ngIf="item.label.trim() === 'Termómetro de aceite' || item.label.trim() === 'Termómetro de devanado'" style="font-size: 12px;">°C</span>
        </div>


      </ng-container>
    </div>
  </div>
</div>

           <!-- Tabla Principal -->
           <div>
            <!-- PATIO -->
            <div class="ant-table">
              <div class="ant-table-header" style="background: #f5e6d3; display: grid; grid-template-columns: 1fr 200px 1fr; border-bottom: 1px solid black;">
                <div class="ant-typography" style="padding: 8px; font-weight: bold;">PATIO DE SUB ESTACIÓN</div>
                <div style="border-left: 1px solid black; border-right: 1px solid black;">
                  <div class="ant-typography" style="text-align: center; font-weight: bold; padding: 8px; border-bottom: 1px solid black;">ESTADO</div>
                  <div style="display: grid; grid-template-columns: repeat(3, 1fr); text-align: center;">
                    <div style="padding: 4px;">"✓"</div>
                    <div style="padding: 4px; border-left: 1px solid black; border-right: 1px solid black;">"X"</div>
                    <div style="padding: 4px;">"N/A"</div>
                  </div>
                </div>
                <div class="ant-typography" style="padding: 8px; font-weight: bold; text-align: center;">OBSERVACIONES</div>
              </div>

              <div class="ant-table-body">
                <div *ngFor="let obs of patioObservaciones; let i = index" style="display: grid; grid-template-columns: 1fr 200px 1fr; border-bottom: 1px solid black;">
                  <div style="padding: 8px;">{{ obs.descripcion }}</div>
                  <div style="display: grid; grid-template-columns: repeat(3, 1fr); border-left: 1px solid black; border-right: 1px solid black;">
                    <div style="display: flex; align-items: center; justify-content: center; padding: 8px;">
                      <input type="checkbox" [(ngModel)]="patioObservaciones[i].bueno">
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; border-left: 1px solid black; border-right: 1px solid black; padding: 8px;">
                      <input type="checkbox" [(ngModel)]="patioObservaciones[i].malo">
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; padding: 8px;">
                      <input type="checkbox" [(ngModel)]="patioObservaciones[i].na">
                    </div>
                  </div>
                  <div style="padding: 8px;">
                    <input [(ngModel)]="patioObservaciones[i].observaciones" style="width: 100%;">
                  </div>
                </div>
              </div>
            </div>

            <!-- PATIO AVISO -->
            <div style="border-top: 1px solid black;">
              <div style="display: grid; grid-template-columns: 1fr 200px 100px; background: #f5e6d3; border-bottom: 1px solid black;">
                <div style="padding: 8px; font-weight: bold;">RECOMENDACIONES - OBSERVACIONES</div>
                <div style="border-left: 1px solid black; border-right: 1px solid black; text-align: center; font-weight: bold; padding: 8px;">SOLICITA AVISO SAP</div>
                <div style="text-align: center; font-weight: bold; padding: 8px;">SOLICITUD</div>
              </div>

              <div *ngFor="let rec of recomendacionesObservaciones; let i = index" style="display: grid; grid-template-columns: 1fr 200px 100px; border-bottom: 1px solid black;">
                <div style="padding: 8px;">
                  <input [(ngModel)]="recomendacionesObservaciones[i].descripcion" style="width: 100%;">
                </div>
                <div style="border-left: 1px solid black; border-right: 1px solid black; padding: 8px; display: flex; justify-content: center; gap: 16px;">
                  <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="checkbox" [(ngModel)]="recomendacionesObservaciones[i].si"> SI
                  </label>
                  <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="checkbox" [(ngModel)]="recomendacionesObservaciones[i].no"> NO
                  </label>
                </div>
                <div style="padding: 8px;">
                  <input [(ngModel)]="recomendacionesObservaciones[i].solicitud" style="width: 100%;">
                </div>
              </div>
            </div>

            <!-- Sección de Firmas -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; padding: 16px; border-top: 1px solid black;">
              <div style="margin-right: 16px;">
                <div style="margin-bottom: 16px;">
                  <div style="font-weight: bold;">RESP. DEL SERVICIO:</div>
                  <span>{{correoSeleccionado}}</span>
                </div>
                <div style="margin-bottom: 16px;">
                  <span style="font-weight: bold;">N° FOTOCHECK: </span>
                  <input style="width: 128px;" (input)="seleccionarParticipante($event, 'TECNICO')">
                </div>
                <div style="margin-bottom: 16px;">
                  <div style="font-weight: bold;">FIRMA:</div>
                  <img [src]="rutaFirmaSeleccionada" style="width: 80px; height: auto; ">
                </div>
              </div>

              <div>
                <div style="margin-bottom: 16px;">
                  <div style="font-weight: bold;">SUPERVISOR:</div>
                  <span>{{correoSeleccionado1}}</span>
                </div>
                <div style="margin-bottom: 16px;">
                  <span style="font-weight: bold;">N° FOTOCHECK: </span>
                  <input style="width: 128px;"  (input)="seleccionarParticipante($event, 'SUPERVISOR')">
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div>

      <div >
        <h6>GUARDAR</h6>
        <a style="cursor: pointer;" (click)="saveData()">
        <span nz-icon nzType="save" nzTheme="outline" style="font-size: 24px;"></span>
        </a>

        </div>

        <div >
        <h6>PLANO</h6>
        <a (click)="VerPlano()" style="cursor: pointer;">
        <span nz-icon nzType="file-pdf" nzTheme="outline" style="font-size: 24px;"></span>
        </a>
        </div>
    </div>
  </div>
</body>





<ng-template #pdfModal>

  <div class="pdf-container">
    <iframe
      [src]="pdfUrl"

      frameborder="0">
    </iframe>
  </div>
</ng-template>
























<!--<div #pdfContainer style="position: relative;">
	<canvas></canvas>
	<div class="annotationLayer"></div>
  </div>-->




  <!--<p-toast key="error"></p-toast>
  <p-toast key="errorpdf"></p-toast>
  <p-toast key="evaluacion"></p-toast>
  <p-toast key="success"></p-toast>
  <p-confirmDialog></p-confirmDialog>
  <p-toast></p-toast>-->




